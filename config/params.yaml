floor_removal_node:
  ros__parameters:
    # Input topics
    input_cloud_topic: "/lx_camera_node/LxCamera_Cloud"

    # Output topics
    output_floor_cloud_topic: "/floor_cloud"
    output_no_floor_cloud_topic: "/no_floor_cloud"
    output_floor_cloud_voxelized_topic: "/floor_cloud_voxelized"
    output_no_floor_cloud_voxelized_topic: "/no_floor_cloud_voxelized"

    # RANSAC parameters for floor detection
    ransac_distance_threshold: 0.02  # meters - points within this distance are considered inliers
    ransac_max_iterations: 100       # maximum iterations for RANSAC
    floor_normal_z_threshold: 0.7    # minimum Z component of normal in robot frame (Z=up)
                                     # For horizontal floor, nz should be close to 1.0

    # Floor height in robot frame (Z coordinate)
    floor_height: 0.0               # meters - floor Z coordinate in robot frame
                                     # Points with Z <= floor_height + detection_thickness are considered floor

    # Floor region parameters (robot frame: X=forward, Y=left, Z=up)
    floor_detection_thickness: 0.01  # meters - thickness for RANSAC plane detection (noise level)
                                     # Large enough to get sufficient points after voxelization
    floor_removal_thickness: 0.01    # meters - thickness for actual floor removal (inflation)
                                     # Small to preserve objects on floor (e.g., 10cm pallets)
    floor_margin: 0.0               # additional margin around detected floor plane (meters)

    # Voxel grid downsampling (reduces computation and noise)
    use_voxel_grid: true             # enable voxel grid downsampling
    voxel_leaf_size: 0.02            # voxel size (meters) - 2cm for better wall detection

    # Detection range parameters
    max_detection_distance: 15.0     # maximum detection distance from camera (meters)

    # Camera extrinsic parameters
    # NOTE: Default optical->base transform is ALWAYS applied first
    # (optical: X=right,Y=down,Z=forward -> base: X=forward,Y=left,Z=up)

    use_default_transform: false      # true: use only default transform
                                     # false: apply ADDITIONAL extrinsic on top of default

    # Additional extrinsic transform (only used if use_default_transform: false)
    # Applied AFTER default optical->base transform
    # Translation: additional camera offset in robot base frame (meters)
    cam_tx: 0.0                      # X offset (forward)
    cam_ty: 0.0                      # Y offset (left)
    cam_tz: 0.35                      # Z offset (up)

    # Rotation: Euler angles in robot base frame (radians) - ZYX order
    cam_roll: 0.0                   # rotation around X axis (radians)
    cam_pitch: 0.0                 # rotation around Y axis (radians)
    cam_yaw: 0.0                     # rotation around Z axis (radians)

    # ========== YZ Plane Detection Parameters ==========
    # Detect vertical walls (planes perpendicular to X axis)
    enable_yz_plane_detection: true

    # RANSAC parameters for YZ plane detection
    yz_plane_distance_threshold: 0.03   # meters - points within this distance are inliers
    yz_plane_max_iterations: 200        # maximum RANSAC iterations
    yz_plane_normal_x_threshold: 0.3    # minimum X component of normal (perpendicular to X axis)
                                        # Lower threshold for testing - increase if needed

    # Visualization marker thickness extension
    yz_plane_marker_thickness: -0.05      # meters - extend thickness in one direction from detected plane
                                        # Positive: extend in +normal direction (away from origin)
                                        # Negative: extend in -normal direction (toward origin)
                                        # The detected plane position stays fixed, only thickness grows
                                        # Does NOT affect plane detection, only visualization
